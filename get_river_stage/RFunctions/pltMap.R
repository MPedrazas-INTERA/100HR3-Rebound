#===============================================================================
#' Location Map
#'
#' @param BASE list object of shapefiles
#' @param OU character vector of OU
#'
#' @return location map
#'
#' @export
#===============================================================================
pltMap <- function(WL, CAP=NULL, MON, BASE, OU, YYYY=2016){
            
  #-------------------------------------------------------------------------#
  #--Plot Area Based on OU--#
  if(OU == 'HR3'){
    
    #-------------------------------------------------------------------------#
    #--Set-up Initial Plot Area--#
    plot(c(), c(), 
         ylim = c(149817,154577), 
         xlim = c(571521,580021),  
         ann=FALSE, 
         xaxt = 'n', 
         yaxt = 'n', 
         asp=1)
    #-------------------------------------------------------------------------#
    
  } else {
    
    #-------------------------------------------------------------------------#
    #--Set-up Initial Plot Area--#
    plot(c(), c(), 
         ylim = c(144857,150237), 
         xlim = c(566821,572501), 
         ann=FALSE, 
         xaxt = 'n', 
         yaxt = 'n', 
         asp=1)
    #-------------------------------------------------------------------------#
    
  }
  #-------------------------------------------------------------------------#
  
  #-------------------------------------------------------------------------# 
  #--Plot Title--#
  if(is.null(CAP)){
    mtext(paste0(YYYY,' Head for: ',MON),3)
  } else {
    mtext(paste0(YYYY,' Head and Capture for: ',MON),3)
  }
  #-------------------------------------------------------------------------# 
  
  #-------------------------------------------------------------------------#
  #--Plot Base Map Features--#
  plot(BASE$ROADS, add=TRUE, col='grey90')
  plot(BASE$HIGHRIV, add=TRUE, col='grey90')
  #-------------------------------------------------------------------------#      
  
  #-------------------------------------------------------------------------#    
  #--Plot Capture Zone--#
  if(!is.null(CAP)){
    if(OU == 'HR3'){
      image(CAP, col=rgb(164,211,238,150,maxColorValue=255),breaks = c(1,200),use.raster=TRUE, add=TRUE)
    } else {
      image(CAP, col=rgb(164,211,238,150,maxColorValue=255),breaks = c(1,200),use.raster=TRUE, add=TRUE)
    } 
  }
  #-------------------------------------------------------------------------#    
  
  #------------------------------------------------------------------------#
  #--Plot WL Contours--#
  RNG <- range(raster::as.array(WL), na.rm = TRUE)
  BREAKS <- seq(floor(RNG[1]),ceiling(RNG[2]),by=0.5)
  contour(WL,add=TRUE,levels=BREAKS,col="black")
  #------------------------------------------------------------------------#
            
  #-------------------------------------------------------------------------#
  #--Plot North Arrow and Scale--#
  if(OU == 'HR3'){
    SpatialPolygonsRescale(layout.scale.bar(),
                           c(571500,154400),
                           scale=2000,
                           fill=c("transparent","grey50"),
                           plot.grid=FALSE)
    text(571500,154700, "0", cex = 0.4)
    text(573500,154700, "2,000 m", cex = 0.4)
  } else {
    SpatialPolygonsRescale(layout.scale.bar(),
                           c(566821,150000),
                           scale=2000,
                           fill=c("transparent","grey50"),
                           plot.grid=FALSE)
    text(566821,150300, "0", cex = 0.4)
    text(568821,150300, "2,000 m", cex = 0.4)
  }
  #-------------------------------------------------------------------------#          
  
  #-------------------------------------------------------------------------#
  #--Plot Border--#
  box()
  #-------------------------------------------------------------------------#
            
}